km.res <- kmeans(distances, 5, nstart = 25)
fviz_cluster(km.res, distances)
library(tidyverse)
library(TSclust)
library(lubridate)
library(cluster)
library(factoextra)
library(runner)
#Get case data for
raw_data <- read.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&metric=newCasesBySpecimenData&format=csv")
data <- arrange((raw_data %>% filter(date >= "2020-06-01")), date)
#Get case data for
raw_data <- read.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=ltla&metric=newCasesBySpecimenDate&format=csv")
data <- arrange((raw_data %>% filter(date >= "2020-06-01")), date)
b = pivot_wider(data, id_cols = date, names_from = areaName, values_from = newCasesBySpecimenDate)
b <- b %>% select_if(~!any(is.na(.))) %>% select(-date)
c <- b %>% slice(1:800)
distances <- diss(c, "COR")
km.res <- kmeans(distances, 5, nstart = 10)
fviz_cluster(km.res, distances)
data <- arrange((raw_data %>% filter(date >= "2020-05-01")), date)
b = pivot_wider(data, id_cols = date, names_from = areaName, values_from = newCasesBySpecimenDate)
b <- b %>% select_if(~!any(is.na(.))) %>% select(-date)
distances <- diss(b, "COR")
km.res <- kmeans(distances, 6, nstart = 10)
fviz_cluster(km.res, distances)
data
km.res <- kmeans(distances, 7, nstart = 10)
fviz_cluster(km.res, distances)
library(lubridate)
library(tidyverse)
#Get case data for
raw_data <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/b5f5843380b084087b36da7051da4f57/download/downloadConcern?w=")
raw_data
#Get case data for
ba4 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/b5f5843380b084087b36da7051da4f57/download/downloadConcern?w=")
ba4
ba5 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/e86975628168ced8bdc3f280326bae20/download/downloadConcern?w=")
#Get case data for
ba4 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/b5f5843380b084087b36da7051da4f57/download/downloadConcern?w=")
ba4
ba5 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/b5f5843380b084087b36da7051da4f57/download/downloadConcern?w=")
ba2 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/e86975628168ced8bdc3f280326bae20/download/downloadConcern?w=")
ba2
#Get case data for
ba4 <- read.csv("https://sars2.cvr.gla.ac.uk/cog-uk/session/1652cec83415458bdbe672447a145760/download/downloadConcern?w=")
ba4
ba5
ba2
nrow(ba5)
date = Date(08, 05, 2022)
date = Date(08-05-2022)
date = Date("08-05-2022")
date = as.Date("08-05-2022")
ba2 %>% filter(sample_date == date %>% nrow
<- ba2 %>% filter(sample_date == date) %>% nrow
)
a <- ba2 %>% filter(sample_date == date)%>% nrow
a
a <- ba2 %>% filter(sample_date == date)%>% nrow
sample_day = as.Date("08-05-2022")
a <- ba2 %>% filter(sample_date == sample_day)%>% nrow
a
ba2 %>% filter(sample_date == sample_day)%>% nrow
ba2
sample_day = as.Date("2022-05-09")
ba2 %>% filter(sample_date == sample_day)%>% nrow
ba2 %>% count(sample_date)
start_date = "2020-05-01"
ba2 %>% count(sample_date) %>% filter(sample_date >= start_date)
start_date = "2022-05-01"
ba2 %>% count(sample_date) %>% filter(sample_date >= start_date)
df %>% count(sample_date) %>% filter(sample_date >= start_date)
return(a)
occurrences <- function(df){
a <- df %>% count(sample_date) %>% filter(sample_date >= start_date)
return(a)
}
occurrences <- function(df, start_date = "2022-05-01"){
a <- df %>% count(sample_date) %>% filter(sample_date >= start_date)
return(a)
}
occurrences(df)
occurrences(ba4)
occurrences(ba5)
occurrences(ba6)
occurrences(ba2)
occurrences(ba2)
b = occurrences(ba4)
c = occurrences(ba5)
df= a %>% left_join(b, by="sample_date")
m
left_join(a, b, by = "sample_date")
a
a = occurrences(ba2)
b = occurrences(ba4)
c = occurrences(ba5)
left_join(a, b, by = "sample_date")
left_join(a, b, c, by = "sample_date")
purrr::reduce(list(a,b,c), dplyr::left_join, by = 'sample_date')
df <- purrr::reduce(list(a,b,c), dplyr::left_join, by = 'sample_date')
colnames(df) = c("sample_date", "ba2", "ba4", "ba5")
df
occurrences <- function(df, start_date = "2022-04-01"){
a <- df %>% count(sample_date) %>% filter(sample_date >= start_date)
return(a)
}
a = occurrences(ba2)
b = occurrences(ba4)
c = occurrences(ba5)
df <- purrr::reduce(list(a,b,c), dplyr::left_join, by = 'sample_date')
colnames(df) = c("sample_date", "ba2", "ba4", "ba5")
df
ba4_frac = df.ba4 / df.ba2
mutate(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
mutate(df, ba5_frac = ba5 / (ba2 + ba4 + ba5))
plot(df)
plot(df$sample_date, df$ba4_frac)
plot(df$sample_date, df$ba5_frac)
df
mutate!(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
df <- mutate(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
df <- mutate(df, ba5_frac = ba5 / (ba2 + ba4 + ba5))
plot(df$sample_date, df$ba5_frac)
plot(df$sample_date, df$ba5_frac)
plot(df$sample_date, df$ba5)
df$sample_date
df
df$sample_date
df$sample_date[1]
type(df$sample_date[1])
typeof(df$sample_date[1])
as.Date(df$sample_date[1])
typeof(as.Date(df$sample_date[1]))
as.Date(df$sample_date)
plot(as.Date(df$sample_date), df$ba4_frac)
plot(as.Date(df$sample_date), df$ba5_frac)
aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans()
ggplot(my_data, aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans())
ggplot(df, aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans())
install.packages("scales")
ggplot(df, aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans())
library(scales)
ggplot(df, aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans())
library(scales)
library(scales)
library(ggplot2)
ggplot(df, aes(x = VARX, y = VARY)) + geom_point() + scale_y_continuous(trans = log2_trans())
plot(as.Date(df$sample_date), df$ba4_frac, log = "y)
)
)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y")
points(as.Date(df$sample_date), df$ba5_frac, log = "y")
points(as.Date(df$sample_date), df$ba5_frac)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y")
points(as.Date(df$sample_date), df$ba5_frac)
ytick <- seq(0.00001, 1, by = 0.01)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
occurrences <- function(df, start_date = "2022-04-10"){
a <- df %>% count(sample_date) %>% filter(sample_date >= start_date)
return(a)
}
a = occurrences(ba2)
b = occurrences(ba4)
c = occurrences(ba5)
df <- purrr::reduce(list(a,b,c), dplyr::left_join, by = 'sample_date')
colnames(df) = c("sample_date", "ba2", "ba4", "ba5")
df <- mutate(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
df <- mutate(df, ba5_frac = ba5 / (ba2 + ba4 + ba5))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
abline(reg, col=2)
reg<-lm(as.Date(df$sample_date) ~ speed, data = df$ba4_frac)
reg<-lm(as.Date(df$sample_date) ~ df$ba4_frac)
abline(reg, col=2)
abline(reg, col=2)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
abline(reg, col=2)
abline(reg, col=2, untf = TRUE)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
abline(reg, col=2, untf = TRUE)
reg<-lm(as.Date(df$sample_date) ~ df$ba4_frac)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
abline(reg, col=2, untf = TRUE)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
reg <- lm(as.Date(df$sample_date) ~ df$ba4_frac)
reg
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
abline(reg, col=2, untf = TRUE)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
abline(reg, col=2)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
abline(reg, col=2)
abline(reg)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = (0.00001, 1))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.00001, 1))
abline(reg)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.00004, 1))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.00005, 1))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.00006, 1))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1))
ticks = c(0.0001, 0.0002, 0.0004, 0.0008, 0.0016, 0.0032, 0.0064, 0.0128, 0.0256, 0.0512, 0.1024, 0.2048, 0.5096, 1)
ticks = c(0.0001, 0.0002, 0.0004, 0.0008, 0.0016, 0.0032, 0.0064, 0.0128, 0.0256, 0.0512, 0.1024, 0.2048, 0.5096, 1)
axis(side = 1, at = ticks)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), axes = FALSE)
ticks = c(0.0001, 0.0002, 0.0004, 0.0008, 0.0016, 0.0032, 0.0064, 0.0128, 0.0256, 0.0512, 0.1024, 0.2048, 0.5096, 1)
axis(side = 1, at = ticks)
axis(side = 2)
axis(side = 2, at = ticks)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), axes = FALSE)
ticks = c(0.0001, 0.0002, 0.0004, 0.0008, 0.0016, 0.0032, 0.0064, 0.0128, 0.0256, 0.0512, 0.1024, 0.2048, 0.5096, 1)
axis(side = 2, at = ticks)
ticks = c(0.0001, 0.0002, 0.0004, 0.0008, 0.0016, 0.0032, 0.0064, 0.0128, 0.0256, 0.0512, 0.1024, 0.2048, 50%)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), axes = FALSE)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
c = (1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
ticks = c(1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
ticks = c(1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
ticks = c(1/256, 1/128, 1/64, 1/32,1/16, 1/8, 1/4, 1/2, 1)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
ticks = c(1/256, 1/128, 1/64, 1/32,1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32,1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32,1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks)
axis(side = 2, at = ticks, labels = ("100%"))
axis(side = 2, at = ticks, labels = c("100%"))
axis(side = 2, at = ticks, labels = c("3.125%", "6.25%", "12.5%", "25%", "50%", "100%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
axis(side = 2, at = ticks, labels = c("3.125%","3.125%", "6.25%", "12.5%", "25%", "50%", "100%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("3.125%","3.125%", "6.25%", "12.5%", "25%", "50%", "100%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("3.125%","3.125%", "6.25%", "12.5%", "25%", "50%", "100%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c("2022-04-10", "2022-05-01")yaxt = "n")
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-05-01")), yaxt = "n")
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-05-26")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
abline(reg)
points(as.Date(df$sample_date), df$ba5_frac, col = 3)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
abline(reg, untf=TRUE)
reg <- lm(formula = (as.Date(df$sample_date) ~ log(df$ba4_frac)))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, untf=TRUE)
abline(reg, untf=TRUE)
abline(reg, untf=TRUE, col = 1)
reg
reg <- lm(formula = (log(df$ba4_frac)) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, untf=TRUE, col = 1)
abline(reg, col = 1)
reg <- lm(formula = (log(df$ba4_frac)) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 1)
abline(reg, col = 2)
reg <- lm(formula = (log(df$ba4_frac)) ~ df$sample_date)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(formula = (log(df$ba4_frac)) ~ as.Date(df$sample_date))
reg <- lm(formula = (df$ba4_frac ~ as.Date(df$sample_date))
reg <- lm(formula = df$ba4_frac ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
abline(reg, untf = TRUE, col = 2)
reg <- lm(df$ba4_frac ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
abline(reg, untf = TRUE, col = 2)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
abline(reg, untf = TRUE, col = 2)
reg
df <- mutate(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
df <- mutate(df, ba5_frac = ba5 / (ba2 + ba4 + ba5))
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(0.0001, 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-12), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
df$ba5_frac
df$sample_date
reg <- lm(log(df$ba4_frac) ~ as.Date(timetest$date, format = "%Y/%m/%d"))
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date, format = "%Y/%m/%d"))
df$sample_date
as.Date(df$sample_date, format = "%Y/%m/%d")
as.Date(df$sample_date)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(df$ba4_frac ~ as.Date(df$sample_date))
reg
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
abline(reg, col = 2, untf = TRUE)
reg <- lm(as.Date(df$sample_date) ~ ln(df$ba4_frac))
reg <- lm(as.Date(df$sample_date) ~ log(df$ba4_frac))
reg
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
reg
log(df$ba4_frac)
abline(reg, col = 2, untf = TRUE)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2, untf = TRUE)
abline(reg, col = 2)
reg
reg <- lm(log(df$ba4_frac) ~ df$sample_date)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
df$sample_date
as.Date(df$sample_date)
as.Date(df$sample_date, format = "YYYY-mm-dd")
as.Date(df$sample_date, format = "%Y-%m-%d")
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date, format = "%Y-%m-%d"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
abline(reg, col = 2)
as.Date(df$sample_date, format = "%Y-%m-%d")
seq(1:10)
seq(1:length(df)
)
df
seq(1:length(df))
seq(1:length(df)[2])
seq(1:length(df))
length(df)
size(df)
nrows(df)
nrow(df)
reg <- lm(log(df$ba4_frac) ~ seq(1:nrow(df)))
reg <- lm(log(df$ba4_frac) ~ seq(1:nrow(df)))
reg
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
df
reg <- lm(log(df$ba4_frac) ~ df$sample_date)
reg
reg <- lm(log(df$ba4_frac) ~ df$sample_date)
rge
reg
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
reg
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(log(df$ba5_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
as.Date(df$sample_date) - as.Date("2022-04-10")
b = as.Date(df$sample_date) - as.Date("2022-04-10")
lm(log(df$ba4_frac) ~ b)
abline(lm(log(df$ba4_frac) ~ b))
log(df$ba4_frac)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date), na.action=na.omit)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date) + other, na.action=na.omit)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date) + Other, na.action=na.omit)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date), na.action=na.omit)
abline(reg, col = 2, untr = TRUE)
abline(reg, col = 2, untrf = TRUE)
abline(reg, col = 2, untf = TRUE)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2, untf = TRUE)
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
a <- df %>% count(sample_date) %>% filter(sample_date >= as.Date(start_date))
a <- df %>% count(sample_date) %>% filter(sample_date >= as.Date(start_date))
first_date <- as.Date("2022-04-10")
a = occurrences(ba2)
b = occurrences(ba4)
c = occurrences(ba5)
df <- purrr::reduce(list(a,b,c), dplyr::left_join, by = 'sample_date')
colnames(df) = c("sample_date", "ba2", "ba4", "ba5")
df <- mutate(df, ba4_frac = ba4 / (ba2 + ba4 + ba5))
df <- mutate(df, ba5_frac = ba5 / (ba2 + ba4 + ba5))
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date), na.action=na.omit)
a =
plot(as.Date(df$sample_date), df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
a = sample_date - first_date
a = df$sample_date - first_date
a = as.Date(df$sample_date) - first_date
reg <- lm(log(df$ba4_frac) ~ a, na.action=na.omit)
reg
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
first_date <- as.Date("2022-04-10")
a = as.Date(df$sample_date) - first_date
reg <- lm(log(df$ba4_frac) ~ a, na.action=na.omit)
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(as.Date("2022-04-10"), as.Date("2022-06-01")), yaxt = "n")
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = (0, 30), as.Date("2022-06-01")), yaxt = "n")
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(0, 30), as.Date("2022-06-01")), yaxt = "n")
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(0, 30), yaxt = "n")
plot(a, df$ba4_frac, log = "y", col = 2, ylim = c(2^(-13), 1), xlim = c(0, 45), yaxt = "n")
4096
ticks = c(1/4096, 1/2048, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1)
axis(side = 2, at = ticks, labels = c("0.024%","0.049%", "0.098%", "0.195%", "0.391%", "0.781%", "1.563%", "3.125%", "6.25%", "12.5%", "25%", "50%", "100%"))
abline(reg, col = 2)
a
reg
exp(-8.712)
df
predict(reg, 0)
predict(reg, [0])
predict(reg, c(0))
predict(reg, c(1))
predict(reg)
plot(reg)
predict(reg)
reg <- lm(log(df$ba4_frac) ~ as.Date(df$sample_date), na.action=na.omit)
reg
predict(reg)
